---
title: css
description: Define and inject CSS rules from JS objects.
layout: ../../../layouts/MainLayout.astro
---

# css

Define and inject CSS rules from JS objects.

## API

```typescript
function css(obj: CSSObject, options?: CSSOptions): string

interface CSSOptions {
  name?: string;    // Custom class name
  global?: boolean; // Apply styles globally
  scoped?: string;  // Scope styles under a parent selector
}

// Core types
type CSSValue = string | number | CSSObject | CSS.Properties;

type CSSSelector =
  | keyof HTMLElementTagNameMap
  | CSS.AtRules
  | CSS.Pseudos
  | (string & {});

type CSSObject = {
  [key in CSSSelector]?: CSSValue;
} & {
  [K in keyof CSS.Properties]?: CSS.Properties[K] | string | number;
};

type PseudoSelectors = {
  [K in CSS.Pseudos]?: CSSValue | CSSObject;
};
```

**Functions:**
- `css(obj, options?)`: Creates and injects CSS rules, returning a class name
- `css.remove(obj, options?)`: Decrements reference count and removes styles if no longer used
- `cssReset()`: Resets the entire CSS system, removing all styles and clearing caches
- `cssVars(vars)`: Creates CSS custom properties from a nested object
- `cssVarsReset()`: Removes all CSS variables

**Types:**
- `CSSOptions`: Configuration options for the `css` function
- `CSSObject`: The shape of CSS objects accepted by `css`
- `CSSValue`: Valid CSS property values
- `CSSSelector`: Valid CSS selectors and at-rules
- `PseudoSelectors`: Pseudo-selector type definitions

## TypeScript

The `css` function accepts a strongly-typed `CSSObject` that supports:
- All standard CSS properties with proper typing
- Nested selectors and pseudo-selectors
- At-rules like `@media` and `@keyframes`
- CSS custom properties (variables)

```typescript
import type { CSSObject, CSSOptions } from '@hellajs/css';

const styles: CSSObject = {
  fontSize: '16px',
  backgroundColor: '#f0f0f0',
  // Nested selectors
  '&:hover': {
    backgroundColor: '#e0e0e0'
  },
  // Media queries
  '@media (max-width: 768px)': {
    fontSize: '14px'
  }
};
```

## Basic Usage

Pass a style object to `css` to get a generated class name.

```jsx
import { css } from '@hellajs/css';

const myClass = css({
  color: 'blue',
  padding: '10px',
  ':hover': {
    color: 'darkblue'
  }
});

<div class={myClass}>Styled Content</div>
```

## Key Concepts

### Scoped & Global Styles
By default, styles are scoped to a generated class. Use the `global` option to inject styles directly, for example, to style base HTML elements.

```jsx
// Scoped (default)
const title = css({ fontSize: '2rem' }); // <h1 class={title}>

// Global
css({ body: { margin: 0 } }, { global: true });
```

### Nesting & Pseudo-Selectors
Nest objects to create styles for child elements or pseudo-states. Use `&` to reference the parent selector.

```jsx
const card = css({
  padding: '1rem',
  'h2': {
    marginTop: 0,
  },
  '&:hover': {
    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',
  }
});
```

### Media Queries & Keyframes
Use at-rules like `@media` and `@keyframes` for responsive design and animations.

```jsx
const responsiveText = css({
  fontSize: '16px',
  '@media (min-width: 768px)': {
    fontSize: '18px',
  }
});

const fadeIn = css({
  '@keyframes fadeIn': {
    from: { opacity: 0 },
    to: { opacity: 1 }
  },
  animation: 'fadeIn 1s ease-in-out',
});
```

### Caching & Memory Management

The CSS system uses intelligent caching and reference counting:

- **Caching**: Identical style objects are cached and reuse the same class name
- **Reference Counting**: Each usage of a style increments a reference counter
- **Automatic Cleanup**: When `css.remove()` is called and the reference count reaches zero, the CSS rule is automatically removed from the DOM
- **Memory Efficiency**: The system automatically cleans up unused styles

```jsx
// Create a style (ref count = 1)
const buttonStyle = css({ color: 'blue' });

// Reusing the same style object returns the same class name (ref count = 2)
const sameStyle = css({ color: 'blue' });

// Remove a reference (ref count = 1)
css.remove({ color: 'blue' });

// Remove the last reference (ref count = 0, CSS rule removed from DOM)
css.remove({ color: 'blue' });
```

### Custom Class Names

You can specify custom class names instead of generated ones:

```jsx
const customButton = css({
  padding: '10px',
  backgroundColor: 'blue'
}, { name: 'my-button' });

// Results in class="my-button" instead of generated class
```

### Parent Scoping

Scope styles under a parent selector:

```jsx
const childStyle = css({
  color: 'red'
}, { scoped: 'parent-container' });

// Generates: .parent-container .c1 { color: red; }
```

## Important Considerations

- **Memory Management**: Always call `css.remove()` for styles that are no longer needed to prevent memory leaks
- **Object Identity**: Style caching is based on deep equality - different object references with same content share styles
- **Performance**: Avoid creating styles in render loops; prefer caching styles at module level
- **Server-Side Rendering**: CSS rules are only injected client-side; consider critical CSS for SSR
- **Style Order**: CSS rules are inserted in order of creation, which affects specificity and cascade

## Use Cases

**Component Library Development**: Create reusable styled components with consistent design tokens:

```jsx
const Button = ({ variant = 'primary', size = 'md', children }) => {
  const buttonStyles = css({
    padding: size === 'sm' ? '0.5rem 1rem' : '0.75rem 1.5rem',
    backgroundColor: variant === 'primary' ? '#007bff' : '#6c757d',
    '&:hover': { opacity: 0.8 }
  });
  return <button class={buttonStyles}>{children}</button>;
};
```

**Theme Implementation**: Build comprehensive theming systems with CSS-in-JS:

```jsx
const createTheme = (colors) => ({
  card: css({
    backgroundColor: colors.background,
    border: `1px solid ${colors.border}`,
    '&:hover': { borderColor: colors.primary }
  }),
  text: css({ color: colors.text })
});
```

**Responsive Design Patterns**: Handle complex responsive layouts with media query nesting:

```jsx
const responsiveGrid = css({
  display: 'grid',
  gap: '1rem',
  gridTemplateColumns: '1fr',
  '@media (min-width: 768px)': { gridTemplateColumns: 'repeat(2, 1fr)' },
  '@media (min-width: 1200px)': { gridTemplateColumns: 'repeat(3, 1fr)' }
});
```

**Animation and Transitions**: Create smooth animations with keyframes and transitions:

```jsx
const loadingSpinner = css({
  '@keyframes spin': { '0%': { transform: 'rotate(0deg)' }, '100%': { transform: 'rotate(360deg)'}},
  animation: 'spin 1s linear infinite',
  width: '20px',
  height: '20px',
  border: '2px solid #f3f3f3',
  borderTop: '2px solid #3498db',
  borderRadius: '50%'
});
```
