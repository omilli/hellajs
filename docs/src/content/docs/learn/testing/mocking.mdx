---
title: Mocking Dependencies
description: How to mock modules and API calls in HellaJS tests
---

# Mocking Dependencies

When unit or integration testing, you often need to replace real dependencies (like API modules) with mock implementations. This allows you to test your components in isolation without making actual network requests.

## Mocking with Vitest

If you're using [Vitest](https://vitest.dev/), you can use its built-in mocking capabilities.

### Mocking an API Module

Imagine a component that fetches data.

```jsx
// api.js
export async function fetchUsers() {
  const response = await fetch('/api/users');
  return response.json();
}

// UserListComponent.jsx
import { signal, effect } from '@hellajs/core';
import { fetchUsers } from './api';

export const UserList = () => {
  const users = signal([]);
  effect(() => {
    fetchUsers().then(data => users(data));
  });

  return (
    <ul>
      {forEach(users, user => <li key={user.id}>{user.name}</li>)}
    </ul>
  );
};
```

You can test this component by mocking the `api.js` module.

```jsx
// UserListComponent.test.jsx
import { render, screen, waitFor } from '@testing-library/dom';
import { vi } from 'vitest';
import { UserList } from './UserListComponent';

// Mock the entire api.js module
vi.mock('./api', () => ({
  fetchUsers: vi.fn(),
}));

// Import the mocked function after mocking
import { fetchUsers } from './api';

describe('UserList', () => {
  it('should display users fetched from the API', async () => {
    const mockUsers = [{ id: 1, name: 'Alice' }, { id: 2, name: 'Bob' }];
    // Configure the mock to return our test data
    fetchUsers.mockResolvedValue(mockUsers);

    render(() => <UserList />);

    // Wait for the component to update after the async fetch
    await waitFor(() => {
      expect(screen.getByText('Alice')).to.exist;
      expect(screen.getByText('Bob')).to.exist;
    });

    // Verify that our mock was called
    expect(fetchUsers).toHaveBeenCalledTimes(1);
  });
});
```

This approach allows you to test your component's rendering and reactive logic without hitting a real API endpoint, making your tests faster and more reliable.
